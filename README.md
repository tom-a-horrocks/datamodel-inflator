# Datamodel Inflator
Generating dataclasses for a given OpenAPI is automated via [datamodel-code-generator](https://github.com/koxudaxi/datamodel-code-generator). However, proceeding to construct instances of those dataclasses after calling the APIis still manual and arduous. This respository automatically construct hierarchies of dataclasses (as generated by datamodel-code-generator) based on type hints. Here's how:

1. Given an OpenAPI specification stored in "up.json", generate a "model.py" file containing dataclass definitions via the following command: `datamodel-codegen --input "up.json" --input-file-type openapi --target-python-version 3.11 --output-model-type dataclasses.dataclass --use-standard-collections --reuse-model --use-schema-description --capitalise-enum-members --use-double-quotes --strict-nullable --output "model.py"`.
2. Call the web API and save the `response.json()` dictionary.
3. Construct a parser for the expected dataclass using `make_parser`. The expected dataclass depends on your API call, but could have Response on the end (e.g. _ListTransactionsResponse_).
4. Provide the parser your `response.json()` dictionary, and you're done!

For example:

```python
import model  # Generated using datamodel-code-generator

# Set up session
token = "<enter your token here>"
session = requests.Session()
header = {"Authorization": f"Bearer {token}"}
session.headers.update(header)

# Make API call
response = session.get(
    "https://api.you.want/api/v1/a_function_which_returns_mydataclass",
)
result = response.json()

# Construct the parser and call it
parser = make_parser(model.MyDataClass)
my_obj = parser(result)
```
